From: David Foster <31405412+foster999@users.noreply.github.com>
Date: Fri, 20 Aug 2021 12:09:22 +0100
Subject: TESTS: Add testing for Python 3.9 and pygments versions (#135)

(cherry picked from commit ade8d9c1e79cd35187cbb48c5df8cc6b9fc5d43b)
---
 .github/workflows/tests.yml                        |   6 +-
 tests/conftest.py                                  |  12 +-
 tests/roots/test-conditionalassets-policy/conf.py  |   5 +
 .../roots/test-conditionalassets-policy/index.rst  | 130 +++++++++++
 .../test-conditionalassets-policy/no_tabs1.rst     |   4 +
 .../test-conditionalassets-policy/no_tabs2.rst     |   4 +
 tests/test_build.py                                |   2 +-
 ...nditional_assets_html_assets_policy_index_.html | 248 +++++++++++++++++++++
 ...onditional_assets_html_assets_policy_index_.xml | 152 +++++++++++++
 ...tional_assets_html_assets_policy_no_tabs1_.html | 248 +++++++++++++++++++++
 ...itional_assets_html_assets_policy_no_tabs1_.xml | 152 +++++++++++++
 ...tional_assets_html_assets_policy_no_tabs2_.html | 248 +++++++++++++++++++++
 ...itional_assets_html_assets_policy_no_tabs2_.xml | 152 +++++++++++++
 .../test_build/test_conditional_assets_index_.html |  58 -----
 .../test_conditional_assets_no_tabs1_.html         |  58 -----
 .../test_conditional_assets_no_tabs2_.html         |  58 -----
 tests/test_build/test_custom_lexer.html            |   9 -
 tests/test_build/test_other_with_assets.html       |   8 -
 .../test_other_with_assets_new_style.html          |   8 -
 19 files changed, 1355 insertions(+), 207 deletions(-)
 create mode 100644 tests/roots/test-conditionalassets-policy/conf.py
 create mode 100644 tests/roots/test-conditionalassets-policy/index.rst
 create mode 100644 tests/roots/test-conditionalassets-policy/no_tabs1.rst
 create mode 100644 tests/roots/test-conditionalassets-policy/no_tabs2.rst
 create mode 100644 tests/test_build/test_conditional_assets_html_assets_policy_index_.html
 create mode 100644 tests/test_build/test_conditional_assets_html_assets_policy_index_.xml
 create mode 100644 tests/test_build/test_conditional_assets_html_assets_policy_no_tabs1_.html
 create mode 100644 tests/test_build/test_conditional_assets_html_assets_policy_no_tabs1_.xml
 create mode 100644 tests/test_build/test_conditional_assets_html_assets_policy_no_tabs2_.html
 create mode 100644 tests/test_build/test_conditional_assets_html_assets_policy_no_tabs2_.xml

diff --git a/.github/workflows/tests.yml b/.github/workflows/tests.yml
index c0767a3..b7414e8 100644
--- a/.github/workflows/tests.yml
+++ b/.github/workflows/tests.yml
@@ -17,8 +17,9 @@ jobs:
     runs-on: ubuntu-latest
     strategy:
       matrix:
-        python-version: [3.6, 3.7, 3.8]
-        sphinx: [">=2,<3", ">=3,<4", "==4.0.0b1"]
+        python-version: [3.6, 3.7, 3.8, 3.9]
+        sphinx: [">=2,<3", ">=3,<4", ">=4,<5"]
+        pygments: ["==2.8.0", "==2.9.0", "==2.10.0"]
 
     steps:
     - uses: actions/checkout@v2
@@ -30,6 +31,7 @@ jobs:
       run: |
         python -m pip install --upgrade pip
         pip install "sphinx${{ matrix.sphinx }}"
+        pip install "pygments${{ matrix.pygments }}"
         pip install .[testing]
     - name: Run pytest
       run: |
diff --git a/tests/conftest.py b/tests/conftest.py
index aea4aa0..6c15bd4 100644
--- a/tests/conftest.py
+++ b/tests/conftest.py
@@ -75,17 +75,19 @@ def regress_sphinx_app_output(file_regression, get_sphinx_app_output):
     non-deterministic).
     """
 
-    def read(
-        app, buildername="html", filename="index.html", encoding="utf-8", replace=None
-    ):
+    def read(app, buildername="html", filename="index.html", encoding="utf-8"):
         content = get_sphinx_app_output(app, buildername, filename, encoding)
 
         if buildername == "html":
             soup = BeautifulSoup(content, "html.parser")
+
+            # Remove output from ``pygments``, so that test only compares HTML of surrounding tabs
+            for div in soup.find_all("div", {"class": "highlight"}):
+                div.decompose()
+
             doc_div = soup.findAll("div", {"class": "documentwrapper"})[0]
             doc = doc_div.prettify()
-            for find, rep in (replace or {}).items():
-                doc = text.replace(find, rep)
+
         else:
             doc = content
         file_regression.check(
diff --git a/tests/roots/test-conditionalassets-policy/conf.py b/tests/roots/test-conditionalassets-policy/conf.py
new file mode 100644
index 0000000..1fc6dcb
--- /dev/null
+++ b/tests/roots/test-conditionalassets-policy/conf.py
@@ -0,0 +1,5 @@
+project = "sphinx-tabs test"
+master_doc = "index"
+source_suffix = ".rst"
+extensions = ["sphinx_tabs.tabs"]
+pygments_style = "sphinx"
diff --git a/tests/roots/test-conditionalassets-policy/index.rst b/tests/roots/test-conditionalassets-policy/index.rst
new file mode 100644
index 0000000..1d1ec6e
--- /dev/null
+++ b/tests/roots/test-conditionalassets-policy/index.rst
@@ -0,0 +1,130 @@
+.. toctree::
+
+   no_tabs1
+   no_tabs2
+
+Fruits
+========================================
+
+.. tabs::
+
+   .. tab:: Apples
+
+      Apples are green, or sometimes red.
+
+   .. tab:: Pears
+
+      Pears are green.
+
+   .. tab:: Oranges
+
+      Oranges are orange.
+
+Luminaries
+========================================
+
+.. tabs::
+
+   .. tab:: Sun
+
+      The sun is a star.
+
+   .. tab:: Moon
+
+      The moon is not a star.
+
+Code Tabs
+========================================
+
+.. tabs::
+
+   .. code-tab:: c
+
+         C Main Function
+
+   .. code-tab:: c++
+
+         C++ Main Function
+
+   .. code-tab:: py
+
+         Python Main Function
+
+   .. code-tab:: java
+
+         Java Main Function
+
+   .. code-tab:: julia
+
+         Julia Main Function
+
+   .. code-tab:: fortran
+
+         Fortran Main Function
+
+.. tabs::
+
+   .. code-tab:: c
+
+         int main(const int argc, const char **argv) {
+           return 0;
+         }
+
+   .. code-tab:: c++
+
+         int main(const int argc, const char **argv) {
+           return 0;
+         }
+
+   .. code-tab:: py
+
+         def main():
+             return
+
+   .. code-tab:: java
+
+         class Main {
+             public static void main(String[] args) {
+             }
+         }
+
+   .. code-tab:: julia
+
+         function main()
+         end
+
+   .. code-tab:: fortran
+
+         PROGRAM main
+         END PROGRAM main
+
+Group Tabs
+========================================
+
+.. tabs::
+
+   .. group-tab:: Linux
+
+      Linux Line 1
+
+   .. group-tab:: Mac OSX
+
+      Mac OSX Line 1
+
+   .. group-tab:: Windows
+
+      Windows Line 1
+
+.. tabs::
+
+   .. group-tab:: Linux
+
+      Linux Line 2
+
+   .. group-tab:: Mac OSX
+
+      Mac OSX Line 2
+
+   .. group-tab:: Windows
+
+      Windows Line 2
diff --git a/tests/roots/test-conditionalassets-policy/no_tabs1.rst b/tests/roots/test-conditionalassets-policy/no_tabs1.rst
new file mode 100644
index 0000000..291ccfa
--- /dev/null
+++ b/tests/roots/test-conditionalassets-policy/no_tabs1.rst
@@ -0,0 +1,4 @@
+Another page without tabs
+========================================
+
+No tabs to see here
diff --git a/tests/roots/test-conditionalassets-policy/no_tabs2.rst b/tests/roots/test-conditionalassets-policy/no_tabs2.rst
new file mode 100644
index 0000000..99ef57d
--- /dev/null
+++ b/tests/roots/test-conditionalassets-policy/no_tabs2.rst
@@ -0,0 +1,4 @@
+And another page without tabs
+========================================
+
+No tabs to see here either
diff --git a/tests/test_build.py b/tests/test_build.py
index 37a63bd..a44a9ef 100644
--- a/tests/test_build.py
+++ b/tests/test_build.py
@@ -27,7 +27,7 @@ def test_conditional_assets(app, docname, check_asset_links):
 
 @pytest.mark.noautobuild
 @pytest.mark.parametrize("docname", ["index", "no_tabs1", "no_tabs2"])
-@pytest.mark.sphinx(testroot="conditionalassets")
+@pytest.mark.sphinx(testroot="conditionalassets-policy")
 @pytest.mark.skipif(
     sphinx.version_info[:2] < (4, 1), reason="Test uses Sphinx 4.1 config"
 )
diff --git a/tests/test_build/test_conditional_assets_html_assets_policy_index_.html b/tests/test_build/test_conditional_assets_html_assets_policy_index_.html
new file mode 100644
index 0000000..c9ba110
--- /dev/null
+++ b/tests/test_build/test_conditional_assets_html_assets_policy_index_.html
@@ -0,0 +1,248 @@
+<div class="documentwrapper">
+ <div class="bodywrapper">
+  <div class="body" role="main">
+   <div class="toctree-wrapper compound">
+    <ul>
+     <li class="toctree-l1">
+      <a class="reference internal" href="no_tabs1.html">
+       Another page without tabs
+      </a>
+     </li>
+     <li class="toctree-l1">
+      <a class="reference internal" href="no_tabs2.html">
+       And another page without tabs
+      </a>
+     </li>
+    </ul>
+   </div>
+   <div class="section" id="fruits">
+    <h1>
+     Fruits
+     <a class="headerlink" href="#fruits" title="Permalink to this headline">
+      ¶
+     </a>
+    </h1>
+    <div class="sphinx-tabs docutils container">
+     <div aria-label="Tabbed content" class="closeable" role="tablist">
+      <button aria-controls="panel-0-0-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-0-0-0" name="0-0" role="tab" tabindex="0">
+       Apples
+      </button>
+      <button aria-controls="panel-0-0-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-0-0-1" name="0-1" role="tab" tabindex="-1">
+       Pears
+      </button>
+      <button aria-controls="panel-0-0-2" aria-selected="false" class="sphinx-tabs-tab" id="tab-0-0-2" name="0-2" role="tab" tabindex="-1">
+       Oranges
+      </button>
+     </div>
+     <div aria-labelledby="tab-0-0-0" class="sphinx-tabs-panel" id="panel-0-0-0" name="0-0" role="tabpanel" tabindex="0">
+      <p>
+       Apples are green, or sometimes red.
+      </p>
+     </div>
+     <div aria-labelledby="tab-0-0-1" class="sphinx-tabs-panel" hidden="true" id="panel-0-0-1" name="0-1" role="tabpanel" tabindex="0">
+      <p>
+       Pears are green.
+      </p>
+     </div>
+     <div aria-labelledby="tab-0-0-2" class="sphinx-tabs-panel" hidden="true" id="panel-0-0-2" name="0-2" role="tabpanel" tabindex="0">
+      <p>
+       Oranges are orange.
+      </p>
+     </div>
+    </div>
+   </div>
+   <div class="section" id="luminaries">
+    <h1>
+     Luminaries
+     <a class="headerlink" href="#luminaries" title="Permalink to this headline">
+      ¶
+     </a>
+    </h1>
+    <div class="sphinx-tabs docutils container">
+     <div aria-label="Tabbed content" class="closeable" role="tablist">
+      <button aria-controls="panel-1-1-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-1-1-0" name="1-0" role="tab" tabindex="0">
+       Sun
+      </button>
+      <button aria-controls="panel-1-1-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-1-1-1" name="1-1" role="tab" tabindex="-1">
+       Moon
+      </button>
+     </div>
+     <div aria-labelledby="tab-1-1-0" class="sphinx-tabs-panel" id="panel-1-1-0" name="1-0" role="tabpanel" tabindex="0">
+      <p>
+       The sun is a star.
+      </p>
+     </div>
+     <div aria-labelledby="tab-1-1-1" class="sphinx-tabs-panel" hidden="true" id="panel-1-1-1" name="1-1" role="tabpanel" tabindex="0">
+      <p>
+       The moon is not a star.
+      </p>
+     </div>
+    </div>
+   </div>
+   <div class="section" id="code-tabs">
+    <h1>
+     Code Tabs
+     <a class="headerlink" href="#code-tabs" title="Permalink to this headline">
+      ¶
+     </a>
+    </h1>
+    <div class="sphinx-tabs docutils container">
+     <div aria-label="Tabbed content" class="closeable" role="tablist">
+      <button aria-controls="panel-2-Qw==" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-2-Qw==" name="Qw==" role="tab" tabindex="0">
+       C
+      </button>
+      <button aria-controls="panel-2-Qysr" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-2-Qysr" name="Qysr" role="tab" tabindex="-1">
+       C++
+      </button>
+      <button aria-controls="panel-2-UHl0aG9u" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-2-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="-1">
+       Python
+      </button>
+      <button aria-controls="panel-2-SmF2YQ==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-2-SmF2YQ==" name="SmF2YQ==" role="tab" tabindex="-1">
+       Java
+      </button>
+      <button aria-controls="panel-2-SnVsaWE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-2-SnVsaWE=" name="SnVsaWE=" role="tab" tabindex="-1">
+       Julia
+      </button>
+      <button aria-controls="panel-2-Rm9ydHJhbg==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-2-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tab" tabindex="-1">
+       Fortran
+      </button>
+     </div>
+     <div aria-labelledby="tab-2-Qw==" class="sphinx-tabs-panel code-tab group-tab" id="panel-2-Qw==" name="Qw==" role="tabpanel" tabindex="0">
+      <div class="highlight-c notranslate">
+      </div>
+     </div>
+     <div aria-labelledby="tab-2-Qysr" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-2-Qysr" name="Qysr" role="tabpanel" tabindex="0">
+      <div class="highlight-c++ notranslate">
+      </div>
+     </div>
+     <div aria-labelledby="tab-2-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-2-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0">
+      <div class="highlight-py notranslate">
+      </div>
+     </div>
+     <div aria-labelledby="tab-2-SmF2YQ==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-2-SmF2YQ==" name="SmF2YQ==" role="tabpanel" tabindex="0">
+      <div class="highlight-java notranslate">
+      </div>
+     </div>
+     <div aria-labelledby="tab-2-SnVsaWE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-2-SnVsaWE=" name="SnVsaWE=" role="tabpanel" tabindex="0">
+      <div class="highlight-julia notranslate">
+      </div>
+     </div>
+     <div aria-labelledby="tab-2-Rm9ydHJhbg==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-2-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tabpanel" tabindex="0">
+      <div class="highlight-fortran notranslate">
+      </div>
+     </div>
+    </div>
+    <div class="sphinx-tabs docutils container">
+     <div aria-label="Tabbed content" class="closeable" role="tablist">
+      <button aria-controls="panel-3-Qw==" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-3-Qw==" name="Qw==" role="tab" tabindex="0">
+       C
+      </button>
+      <button aria-controls="panel-3-Qysr" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-3-Qysr" name="Qysr" role="tab" tabindex="-1">
+       C++
+      </button>
+      <button aria-controls="panel-3-UHl0aG9u" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-3-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="-1">
+       Python
+      </button>
+      <button aria-controls="panel-3-SmF2YQ==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-3-SmF2YQ==" name="SmF2YQ==" role="tab" tabindex="-1">
+       Java
+      </button>
+      <button aria-controls="panel-3-SnVsaWE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-3-SnVsaWE=" name="SnVsaWE=" role="tab" tabindex="-1">
+       Julia
+      </button>
+      <button aria-controls="panel-3-Rm9ydHJhbg==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-3-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tab" tabindex="-1">
+       Fortran
+      </button>
+     </div>
+     <div aria-labelledby="tab-3-Qw==" class="sphinx-tabs-panel code-tab group-tab" id="panel-3-Qw==" name="Qw==" role="tabpanel" tabindex="0">
+      <div class="highlight-c notranslate">
+      </div>
+     </div>
+     <div aria-labelledby="tab-3-Qysr" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-3-Qysr" name="Qysr" role="tabpanel" tabindex="0">
+      <div class="highlight-c++ notranslate">
+      </div>
+     </div>
+     <div aria-labelledby="tab-3-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-3-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0">
+      <div class="highlight-py notranslate">
+      </div>
+     </div>
+     <div aria-labelledby="tab-3-SmF2YQ==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-3-SmF2YQ==" name="SmF2YQ==" role="tabpanel" tabindex="0">
+      <div class="highlight-java notranslate">
+      </div>
+     </div>
+     <div aria-labelledby="tab-3-SnVsaWE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-3-SnVsaWE=" name="SnVsaWE=" role="tabpanel" tabindex="0">
+      <div class="highlight-julia notranslate">
+      </div>
+     </div>
+     <div aria-labelledby="tab-3-Rm9ydHJhbg==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-3-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tabpanel" tabindex="0">
+      <div class="highlight-fortran notranslate">
+      </div>
+     </div>
+    </div>
+   </div>
+   <div class="section" id="group-tabs">
+    <h1>
+     Group Tabs
+     <a class="headerlink" href="#group-tabs" title="Permalink to this headline">
+      ¶
+     </a>
+    </h1>
+    <div class="sphinx-tabs docutils container">
+     <div aria-label="Tabbed content" class="closeable" role="tablist">
+      <button aria-controls="panel-4-TGludXg=" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-4-TGludXg=" name="TGludXg=" role="tab" tabindex="0">
+       Linux
+      </button>
+      <button aria-controls="panel-4-TWFjIE9TWA==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-4-TWFjIE9TWA==" name="TWFjIE9TWA==" role="tab" tabindex="-1">
+       Mac OSX
+      </button>
+      <button aria-controls="panel-4-V2luZG93cw==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-4-V2luZG93cw==" name="V2luZG93cw==" role="tab" tabindex="-1">
+       Windows
+      </button>
+     </div>
+     <div aria-labelledby="tab-4-TGludXg=" class="sphinx-tabs-panel group-tab" id="panel-4-TGludXg=" name="TGludXg=" role="tabpanel" tabindex="0">
+      <p>
+       Linux Line 1
+      </p>
+     </div>
+     <div aria-labelledby="tab-4-TWFjIE9TWA==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-4-TWFjIE9TWA==" name="TWFjIE9TWA==" role="tabpanel" tabindex="0">
+      <p>
+       Mac OSX Line 1
+      </p>
+     </div>
+     <div aria-labelledby="tab-4-V2luZG93cw==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-4-V2luZG93cw==" name="V2luZG93cw==" role="tabpanel" tabindex="0">
+      <p>
+       Windows Line 1
+      </p>
+     </div>
+    </div>
+    <div class="sphinx-tabs docutils container">
+     <div aria-label="Tabbed content" class="closeable" role="tablist">
+      <button aria-controls="panel-5-TGludXg=" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-5-TGludXg=" name="TGludXg=" role="tab" tabindex="0">
+       Linux
+      </button>
+      <button aria-controls="panel-5-TWFjIE9TWA==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-5-TWFjIE9TWA==" name="TWFjIE9TWA==" role="tab" tabindex="-1">
+       Mac OSX
+      </button>
+      <button aria-controls="panel-5-V2luZG93cw==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-5-V2luZG93cw==" name="V2luZG93cw==" role="tab" tabindex="-1">
+       Windows
+      </button>
+     </div>
+     <div aria-labelledby="tab-5-TGludXg=" class="sphinx-tabs-panel group-tab" id="panel-5-TGludXg=" name="TGludXg=" role="tabpanel" tabindex="0">
+      <p>
+       Linux Line 2
+      </p>
+     </div>
+     <div aria-labelledby="tab-5-TWFjIE9TWA==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-5-TWFjIE9TWA==" name="TWFjIE9TWA==" role="tabpanel" tabindex="0">
+      <p>
+       Mac OSX Line 2
+      </p>
+     </div>
+     <div aria-labelledby="tab-5-V2luZG93cw==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-5-V2luZG93cw==" name="V2luZG93cw==" role="tabpanel" tabindex="0">
+      <p>
+       Windows Line 2
+      </p>
+     </div>
+    </div>
+   </div>
+  </div>
+ </div>
+</div>
diff --git a/tests/test_build/test_conditional_assets_html_assets_policy_index_.xml b/tests/test_build/test_conditional_assets_html_assets_policy_index_.xml
new file mode 100644
index 0000000..7fe4f8f
--- /dev/null
+++ b/tests/test_build/test_conditional_assets_html_assets_policy_index_.xml
@@ -0,0 +1,152 @@
+<document source="index.rst">
+    <compound classes="toctree-wrapper">
+        <toctree caption="True" entries="(None,\ 'no_tabs1') (None,\ 'no_tabs2')" glob="False" hidden="False" includefiles="no_tabs1 no_tabs2" includehidden="False" maxdepth="-1" numbered="0" parent="index" rawentries="" titlesonly="False">
+    <section ids="fruits" names="fruits">
+        <title>
+            Fruits
+        <container classes="sphinx-tabs" type="tab-element">
+            <div aria-label="Tabbed content" classes="closeable" role="tablist">
+                <button aria-controls="panel-0-0-0" aria-selected="true" classes="sphinx-tabs-tab" ids="tab-0-0-0" name="0-0" role="tab" tabindex="0">
+                    Apples
+                <button aria-controls="panel-0-0-1" aria-selected="false" classes="sphinx-tabs-tab" ids="tab-0-0-1" name="0-1" role="tab" tabindex="-1">
+                    Pears
+                <button aria-controls="panel-0-0-2" aria-selected="false" classes="sphinx-tabs-tab" ids="tab-0-0-2" name="0-2" role="tab" tabindex="-1">
+                    Oranges
+            <div aria-labelledby="tab-0-0-0" classes="sphinx-tabs-panel" ids="panel-0-0-0" name="0-0" role="tabpanel" tabindex="0">
+                <paragraph>
+                    Apples are green, or sometimes red.
+            <div aria-labelledby="tab-0-0-1" classes="sphinx-tabs-panel" hidden="true" ids="panel-0-0-1" name="0-1" role="tabpanel" tabindex="0">
+                <paragraph>
+                    Pears are green.
+            <div aria-labelledby="tab-0-0-2" classes="sphinx-tabs-panel" hidden="true" ids="panel-0-0-2" name="0-2" role="tabpanel" tabindex="0">
+                <paragraph>
+                    Oranges are orange.
+    <section ids="luminaries" names="luminaries">
+        <title>
+            Luminaries
+        <container classes="sphinx-tabs" type="tab-element">
+            <div aria-label="Tabbed content" classes="closeable" role="tablist">
+                <button aria-controls="panel-1-1-0" aria-selected="true" classes="sphinx-tabs-tab" ids="tab-1-1-0" name="1-0" role="tab" tabindex="0">
+                    Sun
+                <button aria-controls="panel-1-1-1" aria-selected="false" classes="sphinx-tabs-tab" ids="tab-1-1-1" name="1-1" role="tab" tabindex="-1">
+                    Moon
+            <div aria-labelledby="tab-1-1-0" classes="sphinx-tabs-panel" ids="panel-1-1-0" name="1-0" role="tabpanel" tabindex="0">
+                <paragraph>
+                    The sun is a star.
+            <div aria-labelledby="tab-1-1-1" classes="sphinx-tabs-panel" hidden="true" ids="panel-1-1-1" name="1-1" role="tabpanel" tabindex="0">
+                <paragraph>
+                    The moon is not a star.
+    <section ids="code-tabs" names="code\ tabs">
+        <title>
+            Code Tabs
+        <container classes="sphinx-tabs" type="tab-element">
+            <div aria-label="Tabbed content" classes="closeable" role="tablist">
+                <button aria-controls="panel-2-Qw==" aria-selected="true" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-2-Qw==" name="Qw==" role="tab" tabindex="0">
+                    C
+                <button aria-controls="panel-2-Qysr" aria-selected="false" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-2-Qysr" name="Qysr" role="tab" tabindex="-1">
+                    C++
+                <button aria-controls="panel-2-UHl0aG9u" aria-selected="false" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-2-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="-1">
+                    Python
+                <button aria-controls="panel-2-SmF2YQ==" aria-selected="false" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-2-SmF2YQ==" name="SmF2YQ==" role="tab" tabindex="-1">
+                    Java
+                <button aria-controls="panel-2-SnVsaWE=" aria-selected="false" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-2-SnVsaWE=" name="SnVsaWE=" role="tab" tabindex="-1">
+                    Julia
+                <button aria-controls="panel-2-Rm9ydHJhbg==" aria-selected="false" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-2-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tab" tabindex="-1">
+                    Fortran
+            <div aria-labelledby="tab-2-Qw==" classes="sphinx-tabs-panel code-tab group-tab" ids="panel-2-Qw==" name="Qw==" role="tabpanel" tabindex="0">
+                <literal_block force="False" highlight_args="{}" language="c" xml:space="preserve">
+                    C Main Function
+            <div aria-labelledby="tab-2-Qysr" classes="sphinx-tabs-panel code-tab group-tab" hidden="true" ids="panel-2-Qysr" name="Qysr" role="tabpanel" tabindex="0">
+                <literal_block force="False" highlight_args="{}" language="c++" xml:space="preserve">
+                    C++ Main Function
+            <div aria-labelledby="tab-2-UHl0aG9u" classes="sphinx-tabs-panel code-tab group-tab" hidden="true" ids="panel-2-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0">
+                <literal_block force="False" highlight_args="{}" language="py" xml:space="preserve">
+                    Python Main Function
+            <div aria-labelledby="tab-2-SmF2YQ==" classes="sphinx-tabs-panel code-tab group-tab" hidden="true" ids="panel-2-SmF2YQ==" name="SmF2YQ==" role="tabpanel" tabindex="0">
+                <literal_block force="False" highlight_args="{}" language="java" xml:space="preserve">
+                    Java Main Function
+            <div aria-labelledby="tab-2-SnVsaWE=" classes="sphinx-tabs-panel code-tab group-tab" hidden="true" ids="panel-2-SnVsaWE=" name="SnVsaWE=" role="tabpanel" tabindex="0">
+                <literal_block force="False" highlight_args="{}" language="julia" xml:space="preserve">
+                    Julia Main Function
+            <div aria-labelledby="tab-2-Rm9ydHJhbg==" classes="sphinx-tabs-panel code-tab group-tab" hidden="true" ids="panel-2-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tabpanel" tabindex="0">
+                <literal_block force="False" highlight_args="{}" language="fortran" xml:space="preserve">
+                    Fortran Main Function
+        <container classes="sphinx-tabs" type="tab-element">
+            <div aria-label="Tabbed content" classes="closeable" role="tablist">
+                <button aria-controls="panel-3-Qw==" aria-selected="true" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-3-Qw==" name="Qw==" role="tab" tabindex="0">
+                    C
+                <button aria-controls="panel-3-Qysr" aria-selected="false" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-3-Qysr" name="Qysr" role="tab" tabindex="-1">
+                    C++
+                <button aria-controls="panel-3-UHl0aG9u" aria-selected="false" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-3-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="-1">
+                    Python
+                <button aria-controls="panel-3-SmF2YQ==" aria-selected="false" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-3-SmF2YQ==" name="SmF2YQ==" role="tab" tabindex="-1">
+                    Java
+                <button aria-controls="panel-3-SnVsaWE=" aria-selected="false" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-3-SnVsaWE=" name="SnVsaWE=" role="tab" tabindex="-1">
+                    Julia
+                <button aria-controls="panel-3-Rm9ydHJhbg==" aria-selected="false" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-3-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tab" tabindex="-1">
+                    Fortran
+            <div aria-labelledby="tab-3-Qw==" classes="sphinx-tabs-panel code-tab group-tab" ids="panel-3-Qw==" name="Qw==" role="tabpanel" tabindex="0">
+                <literal_block force="False" highlight_args="{}" language="c" xml:space="preserve">
+                    int main(const int argc, const char **argv) {
+                      return 0;
+                    }
+            <div aria-labelledby="tab-3-Qysr" classes="sphinx-tabs-panel code-tab group-tab" hidden="true" ids="panel-3-Qysr" name="Qysr" role="tabpanel" tabindex="0">
+                <literal_block force="False" highlight_args="{}" language="c++" xml:space="preserve">
+                    int main(const int argc, const char **argv) {
+                      return 0;
+                    }
+            <div aria-labelledby="tab-3-UHl0aG9u" classes="sphinx-tabs-panel code-tab group-tab" hidden="true" ids="panel-3-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0">
+                <literal_block force="False" highlight_args="{}" language="py" xml:space="preserve">
+                    def main():
+                        return
+            <div aria-labelledby="tab-3-SmF2YQ==" classes="sphinx-tabs-panel code-tab group-tab" hidden="true" ids="panel-3-SmF2YQ==" name="SmF2YQ==" role="tabpanel" tabindex="0">
+                <literal_block force="False" highlight_args="{}" language="java" xml:space="preserve">
+                    class Main {
+                        public static void main(String[] args) {
+                        }
+                    }
+            <div aria-labelledby="tab-3-SnVsaWE=" classes="sphinx-tabs-panel code-tab group-tab" hidden="true" ids="panel-3-SnVsaWE=" name="SnVsaWE=" role="tabpanel" tabindex="0">
+                <literal_block force="False" highlight_args="{}" language="julia" xml:space="preserve">
+                    function main()
+                    end
+            <div aria-labelledby="tab-3-Rm9ydHJhbg==" classes="sphinx-tabs-panel code-tab group-tab" hidden="true" ids="panel-3-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tabpanel" tabindex="0">
+                <literal_block force="False" highlight_args="{}" language="fortran" xml:space="preserve">
+                    PROGRAM main
+                    END PROGRAM main
+    <section ids="group-tabs" names="group\ tabs">
+        <title>
+            Group Tabs
+        <container classes="sphinx-tabs" type="tab-element">
+            <div aria-label="Tabbed content" classes="closeable" role="tablist">
+                <button aria-controls="panel-4-TGludXg=" aria-selected="true" classes="sphinx-tabs-tab group-tab" ids="tab-4-TGludXg=" name="TGludXg=" role="tab" tabindex="0">
+                    Linux
+                <button aria-controls="panel-4-TWFjIE9TWA==" aria-selected="false" classes="sphinx-tabs-tab group-tab" ids="tab-4-TWFjIE9TWA==" name="TWFjIE9TWA==" role="tab" tabindex="-1">
+                    Mac OSX
+                <button aria-controls="panel-4-V2luZG93cw==" aria-selected="false" classes="sphinx-tabs-tab group-tab" ids="tab-4-V2luZG93cw==" name="V2luZG93cw==" role="tab" tabindex="-1">
+                    Windows
+            <div aria-labelledby="tab-4-TGludXg=" classes="sphinx-tabs-panel group-tab" ids="panel-4-TGludXg=" name="TGludXg=" role="tabpanel" tabindex="0">
+                <paragraph>
+                    Linux Line 1
+            <div aria-labelledby="tab-4-TWFjIE9TWA==" classes="sphinx-tabs-panel group-tab" hidden="true" ids="panel-4-TWFjIE9TWA==" name="TWFjIE9TWA==" role="tabpanel" tabindex="0">
+                <paragraph>
+                    Mac OSX Line 1
+            <div aria-labelledby="tab-4-V2luZG93cw==" classes="sphinx-tabs-panel group-tab" hidden="true" ids="panel-4-V2luZG93cw==" name="V2luZG93cw==" role="tabpanel" tabindex="0">
+                <paragraph>
+                    Windows Line 1
+        <container classes="sphinx-tabs" type="tab-element">
+            <div aria-label="Tabbed content" classes="closeable" role="tablist">
+                <button aria-controls="panel-5-TGludXg=" aria-selected="true" classes="sphinx-tabs-tab group-tab" ids="tab-5-TGludXg=" name="TGludXg=" role="tab" tabindex="0">
+                    Linux
+                <button aria-controls="panel-5-TWFjIE9TWA==" aria-selected="false" classes="sphinx-tabs-tab group-tab" ids="tab-5-TWFjIE9TWA==" name="TWFjIE9TWA==" role="tab" tabindex="-1">
+                    Mac OSX
+                <button aria-controls="panel-5-V2luZG93cw==" aria-selected="false" classes="sphinx-tabs-tab group-tab" ids="tab-5-V2luZG93cw==" name="V2luZG93cw==" role="tab" tabindex="-1">
+                    Windows
+            <div aria-labelledby="tab-5-TGludXg=" classes="sphinx-tabs-panel group-tab" ids="panel-5-TGludXg=" name="TGludXg=" role="tabpanel" tabindex="0">
+                <paragraph>
+                    Linux Line 2
+            <div aria-labelledby="tab-5-TWFjIE9TWA==" classes="sphinx-tabs-panel group-tab" hidden="true" ids="panel-5-TWFjIE9TWA==" name="TWFjIE9TWA==" role="tabpanel" tabindex="0">
+                <paragraph>
+                    Mac OSX Line 2
+            <div aria-labelledby="tab-5-V2luZG93cw==" classes="sphinx-tabs-panel group-tab" hidden="true" ids="panel-5-V2luZG93cw==" name="V2luZG93cw==" role="tabpanel" tabindex="0">
+                <paragraph>
+                    Windows Line 2
diff --git a/tests/test_build/test_conditional_assets_html_assets_policy_no_tabs1_.html b/tests/test_build/test_conditional_assets_html_assets_policy_no_tabs1_.html
new file mode 100644
index 0000000..c9ba110
--- /dev/null
+++ b/tests/test_build/test_conditional_assets_html_assets_policy_no_tabs1_.html
@@ -0,0 +1,248 @@
+<div class="documentwrapper">
+ <div class="bodywrapper">
+  <div class="body" role="main">
+   <div class="toctree-wrapper compound">
+    <ul>
+     <li class="toctree-l1">
+      <a class="reference internal" href="no_tabs1.html">
+       Another page without tabs
+      </a>
+     </li>
+     <li class="toctree-l1">
+      <a class="reference internal" href="no_tabs2.html">
+       And another page without tabs
+      </a>
+     </li>
+    </ul>
+   </div>
+   <div class="section" id="fruits">
+    <h1>
+     Fruits
+     <a class="headerlink" href="#fruits" title="Permalink to this headline">
+      ¶
+     </a>
+    </h1>
+    <div class="sphinx-tabs docutils container">
+     <div aria-label="Tabbed content" class="closeable" role="tablist">
+      <button aria-controls="panel-0-0-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-0-0-0" name="0-0" role="tab" tabindex="0">
+       Apples
+      </button>
+      <button aria-controls="panel-0-0-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-0-0-1" name="0-1" role="tab" tabindex="-1">
+       Pears
+      </button>
+      <button aria-controls="panel-0-0-2" aria-selected="false" class="sphinx-tabs-tab" id="tab-0-0-2" name="0-2" role="tab" tabindex="-1">
+       Oranges
+      </button>
+     </div>
+     <div aria-labelledby="tab-0-0-0" class="sphinx-tabs-panel" id="panel-0-0-0" name="0-0" role="tabpanel" tabindex="0">
+      <p>
+       Apples are green, or sometimes red.
+      </p>
+     </div>
+     <div aria-labelledby="tab-0-0-1" class="sphinx-tabs-panel" hidden="true" id="panel-0-0-1" name="0-1" role="tabpanel" tabindex="0">
+      <p>
+       Pears are green.
+      </p>
+     </div>
+     <div aria-labelledby="tab-0-0-2" class="sphinx-tabs-panel" hidden="true" id="panel-0-0-2" name="0-2" role="tabpanel" tabindex="0">
+      <p>
+       Oranges are orange.
+      </p>
+     </div>
+    </div>
+   </div>
+   <div class="section" id="luminaries">
+    <h1>
+     Luminaries
+     <a class="headerlink" href="#luminaries" title="Permalink to this headline">
+      ¶
+     </a>
+    </h1>
+    <div class="sphinx-tabs docutils container">
+     <div aria-label="Tabbed content" class="closeable" role="tablist">
+      <button aria-controls="panel-1-1-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-1-1-0" name="1-0" role="tab" tabindex="0">
+       Sun
+      </button>
+      <button aria-controls="panel-1-1-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-1-1-1" name="1-1" role="tab" tabindex="-1">
+       Moon
+      </button>
+     </div>
+     <div aria-labelledby="tab-1-1-0" class="sphinx-tabs-panel" id="panel-1-1-0" name="1-0" role="tabpanel" tabindex="0">
+      <p>
+       The sun is a star.
+      </p>
+     </div>
+     <div aria-labelledby="tab-1-1-1" class="sphinx-tabs-panel" hidden="true" id="panel-1-1-1" name="1-1" role="tabpanel" tabindex="0">
+      <p>
+       The moon is not a star.
+      </p>
+     </div>
+    </div>
+   </div>
+   <div class="section" id="code-tabs">
+    <h1>
+     Code Tabs
+     <a class="headerlink" href="#code-tabs" title="Permalink to this headline">
+      ¶
+     </a>
+    </h1>
+    <div class="sphinx-tabs docutils container">
+     <div aria-label="Tabbed content" class="closeable" role="tablist">
+      <button aria-controls="panel-2-Qw==" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-2-Qw==" name="Qw==" role="tab" tabindex="0">
+       C
+      </button>
+      <button aria-controls="panel-2-Qysr" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-2-Qysr" name="Qysr" role="tab" tabindex="-1">
+       C++
+      </button>
+      <button aria-controls="panel-2-UHl0aG9u" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-2-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="-1">
+       Python
+      </button>
+      <button aria-controls="panel-2-SmF2YQ==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-2-SmF2YQ==" name="SmF2YQ==" role="tab" tabindex="-1">
+       Java
+      </button>
+      <button aria-controls="panel-2-SnVsaWE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-2-SnVsaWE=" name="SnVsaWE=" role="tab" tabindex="-1">
+       Julia
+      </button>
+      <button aria-controls="panel-2-Rm9ydHJhbg==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-2-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tab" tabindex="-1">
+       Fortran
+      </button>
+     </div>
+     <div aria-labelledby="tab-2-Qw==" class="sphinx-tabs-panel code-tab group-tab" id="panel-2-Qw==" name="Qw==" role="tabpanel" tabindex="0">
+      <div class="highlight-c notranslate">
+      </div>
+     </div>
+     <div aria-labelledby="tab-2-Qysr" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-2-Qysr" name="Qysr" role="tabpanel" tabindex="0">
+      <div class="highlight-c++ notranslate">
+      </div>
+     </div>
+     <div aria-labelledby="tab-2-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-2-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0">
+      <div class="highlight-py notranslate">
+      </div>
+     </div>
+     <div aria-labelledby="tab-2-SmF2YQ==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-2-SmF2YQ==" name="SmF2YQ==" role="tabpanel" tabindex="0">
+      <div class="highlight-java notranslate">
+      </div>
+     </div>
+     <div aria-labelledby="tab-2-SnVsaWE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-2-SnVsaWE=" name="SnVsaWE=" role="tabpanel" tabindex="0">
+      <div class="highlight-julia notranslate">
+      </div>
+     </div>
+     <div aria-labelledby="tab-2-Rm9ydHJhbg==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-2-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tabpanel" tabindex="0">
+      <div class="highlight-fortran notranslate">
+      </div>
+     </div>
+    </div>
+    <div class="sphinx-tabs docutils container">
+     <div aria-label="Tabbed content" class="closeable" role="tablist">
+      <button aria-controls="panel-3-Qw==" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-3-Qw==" name="Qw==" role="tab" tabindex="0">
+       C
+      </button>
+      <button aria-controls="panel-3-Qysr" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-3-Qysr" name="Qysr" role="tab" tabindex="-1">
+       C++
+      </button>
+      <button aria-controls="panel-3-UHl0aG9u" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-3-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="-1">
+       Python
+      </button>
+      <button aria-controls="panel-3-SmF2YQ==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-3-SmF2YQ==" name="SmF2YQ==" role="tab" tabindex="-1">
+       Java
+      </button>
+      <button aria-controls="panel-3-SnVsaWE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-3-SnVsaWE=" name="SnVsaWE=" role="tab" tabindex="-1">
+       Julia
+      </button>
+      <button aria-controls="panel-3-Rm9ydHJhbg==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-3-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tab" tabindex="-1">
+       Fortran
+      </button>
+     </div>
+     <div aria-labelledby="tab-3-Qw==" class="sphinx-tabs-panel code-tab group-tab" id="panel-3-Qw==" name="Qw==" role="tabpanel" tabindex="0">
+      <div class="highlight-c notranslate">
+      </div>
+     </div>
+     <div aria-labelledby="tab-3-Qysr" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-3-Qysr" name="Qysr" role="tabpanel" tabindex="0">
+      <div class="highlight-c++ notranslate">
+      </div>
+     </div>
+     <div aria-labelledby="tab-3-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-3-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0">
+      <div class="highlight-py notranslate">
+      </div>
+     </div>
+     <div aria-labelledby="tab-3-SmF2YQ==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-3-SmF2YQ==" name="SmF2YQ==" role="tabpanel" tabindex="0">
+      <div class="highlight-java notranslate">
+      </div>
+     </div>
+     <div aria-labelledby="tab-3-SnVsaWE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-3-SnVsaWE=" name="SnVsaWE=" role="tabpanel" tabindex="0">
+      <div class="highlight-julia notranslate">
+      </div>
+     </div>
+     <div aria-labelledby="tab-3-Rm9ydHJhbg==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-3-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tabpanel" tabindex="0">
+      <div class="highlight-fortran notranslate">
+      </div>
+     </div>
+    </div>
+   </div>
+   <div class="section" id="group-tabs">
+    <h1>
+     Group Tabs
+     <a class="headerlink" href="#group-tabs" title="Permalink to this headline">
+      ¶
+     </a>
+    </h1>
+    <div class="sphinx-tabs docutils container">
+     <div aria-label="Tabbed content" class="closeable" role="tablist">
+      <button aria-controls="panel-4-TGludXg=" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-4-TGludXg=" name="TGludXg=" role="tab" tabindex="0">
+       Linux
+      </button>
+      <button aria-controls="panel-4-TWFjIE9TWA==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-4-TWFjIE9TWA==" name="TWFjIE9TWA==" role="tab" tabindex="-1">
+       Mac OSX
+      </button>
+      <button aria-controls="panel-4-V2luZG93cw==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-4-V2luZG93cw==" name="V2luZG93cw==" role="tab" tabindex="-1">
+       Windows
+      </button>
+     </div>
+     <div aria-labelledby="tab-4-TGludXg=" class="sphinx-tabs-panel group-tab" id="panel-4-TGludXg=" name="TGludXg=" role="tabpanel" tabindex="0">
+      <p>
+       Linux Line 1
+      </p>
+     </div>
+     <div aria-labelledby="tab-4-TWFjIE9TWA==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-4-TWFjIE9TWA==" name="TWFjIE9TWA==" role="tabpanel" tabindex="0">
+      <p>
+       Mac OSX Line 1
+      </p>
+     </div>
+     <div aria-labelledby="tab-4-V2luZG93cw==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-4-V2luZG93cw==" name="V2luZG93cw==" role="tabpanel" tabindex="0">
+      <p>
+       Windows Line 1
+      </p>
+     </div>
+    </div>
+    <div class="sphinx-tabs docutils container">
+     <div aria-label="Tabbed content" class="closeable" role="tablist">
+      <button aria-controls="panel-5-TGludXg=" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-5-TGludXg=" name="TGludXg=" role="tab" tabindex="0">
+       Linux
+      </button>
+      <button aria-controls="panel-5-TWFjIE9TWA==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-5-TWFjIE9TWA==" name="TWFjIE9TWA==" role="tab" tabindex="-1">
+       Mac OSX
+      </button>
+      <button aria-controls="panel-5-V2luZG93cw==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-5-V2luZG93cw==" name="V2luZG93cw==" role="tab" tabindex="-1">
+       Windows
+      </button>
+     </div>
+     <div aria-labelledby="tab-5-TGludXg=" class="sphinx-tabs-panel group-tab" id="panel-5-TGludXg=" name="TGludXg=" role="tabpanel" tabindex="0">
+      <p>
+       Linux Line 2
+      </p>
+     </div>
+     <div aria-labelledby="tab-5-TWFjIE9TWA==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-5-TWFjIE9TWA==" name="TWFjIE9TWA==" role="tabpanel" tabindex="0">
+      <p>
+       Mac OSX Line 2
+      </p>
+     </div>
+     <div aria-labelledby="tab-5-V2luZG93cw==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-5-V2luZG93cw==" name="V2luZG93cw==" role="tabpanel" tabindex="0">
+      <p>
+       Windows Line 2
+      </p>
+     </div>
+    </div>
+   </div>
+  </div>
+ </div>
+</div>
diff --git a/tests/test_build/test_conditional_assets_html_assets_policy_no_tabs1_.xml b/tests/test_build/test_conditional_assets_html_assets_policy_no_tabs1_.xml
new file mode 100644
index 0000000..7fe4f8f
--- /dev/null
+++ b/tests/test_build/test_conditional_assets_html_assets_policy_no_tabs1_.xml
@@ -0,0 +1,152 @@
+<document source="index.rst">
+    <compound classes="toctree-wrapper">
+        <toctree caption="True" entries="(None,\ 'no_tabs1') (None,\ 'no_tabs2')" glob="False" hidden="False" includefiles="no_tabs1 no_tabs2" includehidden="False" maxdepth="-1" numbered="0" parent="index" rawentries="" titlesonly="False">
+    <section ids="fruits" names="fruits">
+        <title>
+            Fruits
+        <container classes="sphinx-tabs" type="tab-element">
+            <div aria-label="Tabbed content" classes="closeable" role="tablist">
+                <button aria-controls="panel-0-0-0" aria-selected="true" classes="sphinx-tabs-tab" ids="tab-0-0-0" name="0-0" role="tab" tabindex="0">
+                    Apples
+                <button aria-controls="panel-0-0-1" aria-selected="false" classes="sphinx-tabs-tab" ids="tab-0-0-1" name="0-1" role="tab" tabindex="-1">
+                    Pears
+                <button aria-controls="panel-0-0-2" aria-selected="false" classes="sphinx-tabs-tab" ids="tab-0-0-2" name="0-2" role="tab" tabindex="-1">
+                    Oranges
+            <div aria-labelledby="tab-0-0-0" classes="sphinx-tabs-panel" ids="panel-0-0-0" name="0-0" role="tabpanel" tabindex="0">
+                <paragraph>
+                    Apples are green, or sometimes red.
+            <div aria-labelledby="tab-0-0-1" classes="sphinx-tabs-panel" hidden="true" ids="panel-0-0-1" name="0-1" role="tabpanel" tabindex="0">
+                <paragraph>
+                    Pears are green.
+            <div aria-labelledby="tab-0-0-2" classes="sphinx-tabs-panel" hidden="true" ids="panel-0-0-2" name="0-2" role="tabpanel" tabindex="0">
+                <paragraph>
+                    Oranges are orange.
+    <section ids="luminaries" names="luminaries">
+        <title>
+            Luminaries
+        <container classes="sphinx-tabs" type="tab-element">
+            <div aria-label="Tabbed content" classes="closeable" role="tablist">
+                <button aria-controls="panel-1-1-0" aria-selected="true" classes="sphinx-tabs-tab" ids="tab-1-1-0" name="1-0" role="tab" tabindex="0">
+                    Sun
+                <button aria-controls="panel-1-1-1" aria-selected="false" classes="sphinx-tabs-tab" ids="tab-1-1-1" name="1-1" role="tab" tabindex="-1">
+                    Moon
+            <div aria-labelledby="tab-1-1-0" classes="sphinx-tabs-panel" ids="panel-1-1-0" name="1-0" role="tabpanel" tabindex="0">
+                <paragraph>
+                    The sun is a star.
+            <div aria-labelledby="tab-1-1-1" classes="sphinx-tabs-panel" hidden="true" ids="panel-1-1-1" name="1-1" role="tabpanel" tabindex="0">
+                <paragraph>
+                    The moon is not a star.
+    <section ids="code-tabs" names="code\ tabs">
+        <title>
+            Code Tabs
+        <container classes="sphinx-tabs" type="tab-element">
+            <div aria-label="Tabbed content" classes="closeable" role="tablist">
+                <button aria-controls="panel-2-Qw==" aria-selected="true" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-2-Qw==" name="Qw==" role="tab" tabindex="0">
+                    C
+                <button aria-controls="panel-2-Qysr" aria-selected="false" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-2-Qysr" name="Qysr" role="tab" tabindex="-1">
+                    C++
+                <button aria-controls="panel-2-UHl0aG9u" aria-selected="false" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-2-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="-1">
+                    Python
+                <button aria-controls="panel-2-SmF2YQ==" aria-selected="false" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-2-SmF2YQ==" name="SmF2YQ==" role="tab" tabindex="-1">
+                    Java
+                <button aria-controls="panel-2-SnVsaWE=" aria-selected="false" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-2-SnVsaWE=" name="SnVsaWE=" role="tab" tabindex="-1">
+                    Julia
+                <button aria-controls="panel-2-Rm9ydHJhbg==" aria-selected="false" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-2-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tab" tabindex="-1">
+                    Fortran
+            <div aria-labelledby="tab-2-Qw==" classes="sphinx-tabs-panel code-tab group-tab" ids="panel-2-Qw==" name="Qw==" role="tabpanel" tabindex="0">
+                <literal_block force="False" highlight_args="{}" language="c" xml:space="preserve">
+                    C Main Function
+            <div aria-labelledby="tab-2-Qysr" classes="sphinx-tabs-panel code-tab group-tab" hidden="true" ids="panel-2-Qysr" name="Qysr" role="tabpanel" tabindex="0">
+                <literal_block force="False" highlight_args="{}" language="c++" xml:space="preserve">
+                    C++ Main Function
+            <div aria-labelledby="tab-2-UHl0aG9u" classes="sphinx-tabs-panel code-tab group-tab" hidden="true" ids="panel-2-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0">
+                <literal_block force="False" highlight_args="{}" language="py" xml:space="preserve">
+                    Python Main Function
+            <div aria-labelledby="tab-2-SmF2YQ==" classes="sphinx-tabs-panel code-tab group-tab" hidden="true" ids="panel-2-SmF2YQ==" name="SmF2YQ==" role="tabpanel" tabindex="0">
+                <literal_block force="False" highlight_args="{}" language="java" xml:space="preserve">
+                    Java Main Function
+            <div aria-labelledby="tab-2-SnVsaWE=" classes="sphinx-tabs-panel code-tab group-tab" hidden="true" ids="panel-2-SnVsaWE=" name="SnVsaWE=" role="tabpanel" tabindex="0">
+                <literal_block force="False" highlight_args="{}" language="julia" xml:space="preserve">
+                    Julia Main Function
+            <div aria-labelledby="tab-2-Rm9ydHJhbg==" classes="sphinx-tabs-panel code-tab group-tab" hidden="true" ids="panel-2-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tabpanel" tabindex="0">
+                <literal_block force="False" highlight_args="{}" language="fortran" xml:space="preserve">
+                    Fortran Main Function
+        <container classes="sphinx-tabs" type="tab-element">
+            <div aria-label="Tabbed content" classes="closeable" role="tablist">
+                <button aria-controls="panel-3-Qw==" aria-selected="true" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-3-Qw==" name="Qw==" role="tab" tabindex="0">
+                    C
+                <button aria-controls="panel-3-Qysr" aria-selected="false" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-3-Qysr" name="Qysr" role="tab" tabindex="-1">
+                    C++
+                <button aria-controls="panel-3-UHl0aG9u" aria-selected="false" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-3-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="-1">
+                    Python
+                <button aria-controls="panel-3-SmF2YQ==" aria-selected="false" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-3-SmF2YQ==" name="SmF2YQ==" role="tab" tabindex="-1">
+                    Java
+                <button aria-controls="panel-3-SnVsaWE=" aria-selected="false" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-3-SnVsaWE=" name="SnVsaWE=" role="tab" tabindex="-1">
+                    Julia
+                <button aria-controls="panel-3-Rm9ydHJhbg==" aria-selected="false" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-3-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tab" tabindex="-1">
+                    Fortran
+            <div aria-labelledby="tab-3-Qw==" classes="sphinx-tabs-panel code-tab group-tab" ids="panel-3-Qw==" name="Qw==" role="tabpanel" tabindex="0">
+                <literal_block force="False" highlight_args="{}" language="c" xml:space="preserve">
+                    int main(const int argc, const char **argv) {
+                      return 0;
+                    }
+            <div aria-labelledby="tab-3-Qysr" classes="sphinx-tabs-panel code-tab group-tab" hidden="true" ids="panel-3-Qysr" name="Qysr" role="tabpanel" tabindex="0">
+                <literal_block force="False" highlight_args="{}" language="c++" xml:space="preserve">
+                    int main(const int argc, const char **argv) {
+                      return 0;
+                    }
+            <div aria-labelledby="tab-3-UHl0aG9u" classes="sphinx-tabs-panel code-tab group-tab" hidden="true" ids="panel-3-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0">
+                <literal_block force="False" highlight_args="{}" language="py" xml:space="preserve">
+                    def main():
+                        return
+            <div aria-labelledby="tab-3-SmF2YQ==" classes="sphinx-tabs-panel code-tab group-tab" hidden="true" ids="panel-3-SmF2YQ==" name="SmF2YQ==" role="tabpanel" tabindex="0">
+                <literal_block force="False" highlight_args="{}" language="java" xml:space="preserve">
+                    class Main {
+                        public static void main(String[] args) {
+                        }
+                    }
+            <div aria-labelledby="tab-3-SnVsaWE=" classes="sphinx-tabs-panel code-tab group-tab" hidden="true" ids="panel-3-SnVsaWE=" name="SnVsaWE=" role="tabpanel" tabindex="0">
+                <literal_block force="False" highlight_args="{}" language="julia" xml:space="preserve">
+                    function main()
+                    end
+            <div aria-labelledby="tab-3-Rm9ydHJhbg==" classes="sphinx-tabs-panel code-tab group-tab" hidden="true" ids="panel-3-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tabpanel" tabindex="0">
+                <literal_block force="False" highlight_args="{}" language="fortran" xml:space="preserve">
+                    PROGRAM main
+                    END PROGRAM main
+    <section ids="group-tabs" names="group\ tabs">
+        <title>
+            Group Tabs
+        <container classes="sphinx-tabs" type="tab-element">
+            <div aria-label="Tabbed content" classes="closeable" role="tablist">
+                <button aria-controls="panel-4-TGludXg=" aria-selected="true" classes="sphinx-tabs-tab group-tab" ids="tab-4-TGludXg=" name="TGludXg=" role="tab" tabindex="0">
+                    Linux
+                <button aria-controls="panel-4-TWFjIE9TWA==" aria-selected="false" classes="sphinx-tabs-tab group-tab" ids="tab-4-TWFjIE9TWA==" name="TWFjIE9TWA==" role="tab" tabindex="-1">
+                    Mac OSX
+                <button aria-controls="panel-4-V2luZG93cw==" aria-selected="false" classes="sphinx-tabs-tab group-tab" ids="tab-4-V2luZG93cw==" name="V2luZG93cw==" role="tab" tabindex="-1">
+                    Windows
+            <div aria-labelledby="tab-4-TGludXg=" classes="sphinx-tabs-panel group-tab" ids="panel-4-TGludXg=" name="TGludXg=" role="tabpanel" tabindex="0">
+                <paragraph>
+                    Linux Line 1
+            <div aria-labelledby="tab-4-TWFjIE9TWA==" classes="sphinx-tabs-panel group-tab" hidden="true" ids="panel-4-TWFjIE9TWA==" name="TWFjIE9TWA==" role="tabpanel" tabindex="0">
+                <paragraph>
+                    Mac OSX Line 1
+            <div aria-labelledby="tab-4-V2luZG93cw==" classes="sphinx-tabs-panel group-tab" hidden="true" ids="panel-4-V2luZG93cw==" name="V2luZG93cw==" role="tabpanel" tabindex="0">
+                <paragraph>
+                    Windows Line 1
+        <container classes="sphinx-tabs" type="tab-element">
+            <div aria-label="Tabbed content" classes="closeable" role="tablist">
+                <button aria-controls="panel-5-TGludXg=" aria-selected="true" classes="sphinx-tabs-tab group-tab" ids="tab-5-TGludXg=" name="TGludXg=" role="tab" tabindex="0">
+                    Linux
+                <button aria-controls="panel-5-TWFjIE9TWA==" aria-selected="false" classes="sphinx-tabs-tab group-tab" ids="tab-5-TWFjIE9TWA==" name="TWFjIE9TWA==" role="tab" tabindex="-1">
+                    Mac OSX
+                <button aria-controls="panel-5-V2luZG93cw==" aria-selected="false" classes="sphinx-tabs-tab group-tab" ids="tab-5-V2luZG93cw==" name="V2luZG93cw==" role="tab" tabindex="-1">
+                    Windows
+            <div aria-labelledby="tab-5-TGludXg=" classes="sphinx-tabs-panel group-tab" ids="panel-5-TGludXg=" name="TGludXg=" role="tabpanel" tabindex="0">
+                <paragraph>
+                    Linux Line 2
+            <div aria-labelledby="tab-5-TWFjIE9TWA==" classes="sphinx-tabs-panel group-tab" hidden="true" ids="panel-5-TWFjIE9TWA==" name="TWFjIE9TWA==" role="tabpanel" tabindex="0">
+                <paragraph>
+                    Mac OSX Line 2
+            <div aria-labelledby="tab-5-V2luZG93cw==" classes="sphinx-tabs-panel group-tab" hidden="true" ids="panel-5-V2luZG93cw==" name="V2luZG93cw==" role="tabpanel" tabindex="0">
+                <paragraph>
+                    Windows Line 2
diff --git a/tests/test_build/test_conditional_assets_html_assets_policy_no_tabs2_.html b/tests/test_build/test_conditional_assets_html_assets_policy_no_tabs2_.html
new file mode 100644
index 0000000..c9ba110
--- /dev/null
+++ b/tests/test_build/test_conditional_assets_html_assets_policy_no_tabs2_.html
@@ -0,0 +1,248 @@
+<div class="documentwrapper">
+ <div class="bodywrapper">
+  <div class="body" role="main">
+   <div class="toctree-wrapper compound">
+    <ul>
+     <li class="toctree-l1">
+      <a class="reference internal" href="no_tabs1.html">
+       Another page without tabs
+      </a>
+     </li>
+     <li class="toctree-l1">
+      <a class="reference internal" href="no_tabs2.html">
+       And another page without tabs
+      </a>
+     </li>
+    </ul>
+   </div>
+   <div class="section" id="fruits">
+    <h1>
+     Fruits
+     <a class="headerlink" href="#fruits" title="Permalink to this headline">
+      ¶
+     </a>
+    </h1>
+    <div class="sphinx-tabs docutils container">
+     <div aria-label="Tabbed content" class="closeable" role="tablist">
+      <button aria-controls="panel-0-0-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-0-0-0" name="0-0" role="tab" tabindex="0">
+       Apples
+      </button>
+      <button aria-controls="panel-0-0-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-0-0-1" name="0-1" role="tab" tabindex="-1">
+       Pears
+      </button>
+      <button aria-controls="panel-0-0-2" aria-selected="false" class="sphinx-tabs-tab" id="tab-0-0-2" name="0-2" role="tab" tabindex="-1">
+       Oranges
+      </button>
+     </div>
+     <div aria-labelledby="tab-0-0-0" class="sphinx-tabs-panel" id="panel-0-0-0" name="0-0" role="tabpanel" tabindex="0">
+      <p>
+       Apples are green, or sometimes red.
+      </p>
+     </div>
+     <div aria-labelledby="tab-0-0-1" class="sphinx-tabs-panel" hidden="true" id="panel-0-0-1" name="0-1" role="tabpanel" tabindex="0">
+      <p>
+       Pears are green.
+      </p>
+     </div>
+     <div aria-labelledby="tab-0-0-2" class="sphinx-tabs-panel" hidden="true" id="panel-0-0-2" name="0-2" role="tabpanel" tabindex="0">
+      <p>
+       Oranges are orange.
+      </p>
+     </div>
+    </div>
+   </div>
+   <div class="section" id="luminaries">
+    <h1>
+     Luminaries
+     <a class="headerlink" href="#luminaries" title="Permalink to this headline">
+      ¶
+     </a>
+    </h1>
+    <div class="sphinx-tabs docutils container">
+     <div aria-label="Tabbed content" class="closeable" role="tablist">
+      <button aria-controls="panel-1-1-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-1-1-0" name="1-0" role="tab" tabindex="0">
+       Sun
+      </button>
+      <button aria-controls="panel-1-1-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-1-1-1" name="1-1" role="tab" tabindex="-1">
+       Moon
+      </button>
+     </div>
+     <div aria-labelledby="tab-1-1-0" class="sphinx-tabs-panel" id="panel-1-1-0" name="1-0" role="tabpanel" tabindex="0">
+      <p>
+       The sun is a star.
+      </p>
+     </div>
+     <div aria-labelledby="tab-1-1-1" class="sphinx-tabs-panel" hidden="true" id="panel-1-1-1" name="1-1" role="tabpanel" tabindex="0">
+      <p>
+       The moon is not a star.
+      </p>
+     </div>
+    </div>
+   </div>
+   <div class="section" id="code-tabs">
+    <h1>
+     Code Tabs
+     <a class="headerlink" href="#code-tabs" title="Permalink to this headline">
+      ¶
+     </a>
+    </h1>
+    <div class="sphinx-tabs docutils container">
+     <div aria-label="Tabbed content" class="closeable" role="tablist">
+      <button aria-controls="panel-2-Qw==" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-2-Qw==" name="Qw==" role="tab" tabindex="0">
+       C
+      </button>
+      <button aria-controls="panel-2-Qysr" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-2-Qysr" name="Qysr" role="tab" tabindex="-1">
+       C++
+      </button>
+      <button aria-controls="panel-2-UHl0aG9u" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-2-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="-1">
+       Python
+      </button>
+      <button aria-controls="panel-2-SmF2YQ==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-2-SmF2YQ==" name="SmF2YQ==" role="tab" tabindex="-1">
+       Java
+      </button>
+      <button aria-controls="panel-2-SnVsaWE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-2-SnVsaWE=" name="SnVsaWE=" role="tab" tabindex="-1">
+       Julia
+      </button>
+      <button aria-controls="panel-2-Rm9ydHJhbg==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-2-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tab" tabindex="-1">
+       Fortran
+      </button>
+     </div>
+     <div aria-labelledby="tab-2-Qw==" class="sphinx-tabs-panel code-tab group-tab" id="panel-2-Qw==" name="Qw==" role="tabpanel" tabindex="0">
+      <div class="highlight-c notranslate">
+      </div>
+     </div>
+     <div aria-labelledby="tab-2-Qysr" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-2-Qysr" name="Qysr" role="tabpanel" tabindex="0">
+      <div class="highlight-c++ notranslate">
+      </div>
+     </div>
+     <div aria-labelledby="tab-2-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-2-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0">
+      <div class="highlight-py notranslate">
+      </div>
+     </div>
+     <div aria-labelledby="tab-2-SmF2YQ==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-2-SmF2YQ==" name="SmF2YQ==" role="tabpanel" tabindex="0">
+      <div class="highlight-java notranslate">
+      </div>
+     </div>
+     <div aria-labelledby="tab-2-SnVsaWE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-2-SnVsaWE=" name="SnVsaWE=" role="tabpanel" tabindex="0">
+      <div class="highlight-julia notranslate">
+      </div>
+     </div>
+     <div aria-labelledby="tab-2-Rm9ydHJhbg==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-2-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tabpanel" tabindex="0">
+      <div class="highlight-fortran notranslate">
+      </div>
+     </div>
+    </div>
+    <div class="sphinx-tabs docutils container">
+     <div aria-label="Tabbed content" class="closeable" role="tablist">
+      <button aria-controls="panel-3-Qw==" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-3-Qw==" name="Qw==" role="tab" tabindex="0">
+       C
+      </button>
+      <button aria-controls="panel-3-Qysr" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-3-Qysr" name="Qysr" role="tab" tabindex="-1">
+       C++
+      </button>
+      <button aria-controls="panel-3-UHl0aG9u" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-3-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="-1">
+       Python
+      </button>
+      <button aria-controls="panel-3-SmF2YQ==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-3-SmF2YQ==" name="SmF2YQ==" role="tab" tabindex="-1">
+       Java
+      </button>
+      <button aria-controls="panel-3-SnVsaWE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-3-SnVsaWE=" name="SnVsaWE=" role="tab" tabindex="-1">
+       Julia
+      </button>
+      <button aria-controls="panel-3-Rm9ydHJhbg==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-3-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tab" tabindex="-1">
+       Fortran
+      </button>
+     </div>
+     <div aria-labelledby="tab-3-Qw==" class="sphinx-tabs-panel code-tab group-tab" id="panel-3-Qw==" name="Qw==" role="tabpanel" tabindex="0">
+      <div class="highlight-c notranslate">
+      </div>
+     </div>
+     <div aria-labelledby="tab-3-Qysr" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-3-Qysr" name="Qysr" role="tabpanel" tabindex="0">
+      <div class="highlight-c++ notranslate">
+      </div>
+     </div>
+     <div aria-labelledby="tab-3-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-3-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0">
+      <div class="highlight-py notranslate">
+      </div>
+     </div>
+     <div aria-labelledby="tab-3-SmF2YQ==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-3-SmF2YQ==" name="SmF2YQ==" role="tabpanel" tabindex="0">
+      <div class="highlight-java notranslate">
+      </div>
+     </div>
+     <div aria-labelledby="tab-3-SnVsaWE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-3-SnVsaWE=" name="SnVsaWE=" role="tabpanel" tabindex="0">
+      <div class="highlight-julia notranslate">
+      </div>
+     </div>
+     <div aria-labelledby="tab-3-Rm9ydHJhbg==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-3-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tabpanel" tabindex="0">
+      <div class="highlight-fortran notranslate">
+      </div>
+     </div>
+    </div>
+   </div>
+   <div class="section" id="group-tabs">
+    <h1>
+     Group Tabs
+     <a class="headerlink" href="#group-tabs" title="Permalink to this headline">
+      ¶
+     </a>
+    </h1>
+    <div class="sphinx-tabs docutils container">
+     <div aria-label="Tabbed content" class="closeable" role="tablist">
+      <button aria-controls="panel-4-TGludXg=" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-4-TGludXg=" name="TGludXg=" role="tab" tabindex="0">
+       Linux
+      </button>
+      <button aria-controls="panel-4-TWFjIE9TWA==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-4-TWFjIE9TWA==" name="TWFjIE9TWA==" role="tab" tabindex="-1">
+       Mac OSX
+      </button>
+      <button aria-controls="panel-4-V2luZG93cw==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-4-V2luZG93cw==" name="V2luZG93cw==" role="tab" tabindex="-1">
+       Windows
+      </button>
+     </div>
+     <div aria-labelledby="tab-4-TGludXg=" class="sphinx-tabs-panel group-tab" id="panel-4-TGludXg=" name="TGludXg=" role="tabpanel" tabindex="0">
+      <p>
+       Linux Line 1
+      </p>
+     </div>
+     <div aria-labelledby="tab-4-TWFjIE9TWA==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-4-TWFjIE9TWA==" name="TWFjIE9TWA==" role="tabpanel" tabindex="0">
+      <p>
+       Mac OSX Line 1
+      </p>
+     </div>
+     <div aria-labelledby="tab-4-V2luZG93cw==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-4-V2luZG93cw==" name="V2luZG93cw==" role="tabpanel" tabindex="0">
+      <p>
+       Windows Line 1
+      </p>
+     </div>
+    </div>
+    <div class="sphinx-tabs docutils container">
+     <div aria-label="Tabbed content" class="closeable" role="tablist">
+      <button aria-controls="panel-5-TGludXg=" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-5-TGludXg=" name="TGludXg=" role="tab" tabindex="0">
+       Linux
+      </button>
+      <button aria-controls="panel-5-TWFjIE9TWA==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-5-TWFjIE9TWA==" name="TWFjIE9TWA==" role="tab" tabindex="-1">
+       Mac OSX
+      </button>
+      <button aria-controls="panel-5-V2luZG93cw==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-5-V2luZG93cw==" name="V2luZG93cw==" role="tab" tabindex="-1">
+       Windows
+      </button>
+     </div>
+     <div aria-labelledby="tab-5-TGludXg=" class="sphinx-tabs-panel group-tab" id="panel-5-TGludXg=" name="TGludXg=" role="tabpanel" tabindex="0">
+      <p>
+       Linux Line 2
+      </p>
+     </div>
+     <div aria-labelledby="tab-5-TWFjIE9TWA==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-5-TWFjIE9TWA==" name="TWFjIE9TWA==" role="tabpanel" tabindex="0">
+      <p>
+       Mac OSX Line 2
+      </p>
+     </div>
+     <div aria-labelledby="tab-5-V2luZG93cw==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-5-V2luZG93cw==" name="V2luZG93cw==" role="tabpanel" tabindex="0">
+      <p>
+       Windows Line 2
+      </p>
+     </div>
+    </div>
+   </div>
+  </div>
+ </div>
+</div>
diff --git a/tests/test_build/test_conditional_assets_html_assets_policy_no_tabs2_.xml b/tests/test_build/test_conditional_assets_html_assets_policy_no_tabs2_.xml
new file mode 100644
index 0000000..7fe4f8f
--- /dev/null
+++ b/tests/test_build/test_conditional_assets_html_assets_policy_no_tabs2_.xml
@@ -0,0 +1,152 @@
+<document source="index.rst">
+    <compound classes="toctree-wrapper">
+        <toctree caption="True" entries="(None,\ 'no_tabs1') (None,\ 'no_tabs2')" glob="False" hidden="False" includefiles="no_tabs1 no_tabs2" includehidden="False" maxdepth="-1" numbered="0" parent="index" rawentries="" titlesonly="False">
+    <section ids="fruits" names="fruits">
+        <title>
+            Fruits
+        <container classes="sphinx-tabs" type="tab-element">
+            <div aria-label="Tabbed content" classes="closeable" role="tablist">
+                <button aria-controls="panel-0-0-0" aria-selected="true" classes="sphinx-tabs-tab" ids="tab-0-0-0" name="0-0" role="tab" tabindex="0">
+                    Apples
+                <button aria-controls="panel-0-0-1" aria-selected="false" classes="sphinx-tabs-tab" ids="tab-0-0-1" name="0-1" role="tab" tabindex="-1">
+                    Pears
+                <button aria-controls="panel-0-0-2" aria-selected="false" classes="sphinx-tabs-tab" ids="tab-0-0-2" name="0-2" role="tab" tabindex="-1">
+                    Oranges
+            <div aria-labelledby="tab-0-0-0" classes="sphinx-tabs-panel" ids="panel-0-0-0" name="0-0" role="tabpanel" tabindex="0">
+                <paragraph>
+                    Apples are green, or sometimes red.
+            <div aria-labelledby="tab-0-0-1" classes="sphinx-tabs-panel" hidden="true" ids="panel-0-0-1" name="0-1" role="tabpanel" tabindex="0">
+                <paragraph>
+                    Pears are green.
+            <div aria-labelledby="tab-0-0-2" classes="sphinx-tabs-panel" hidden="true" ids="panel-0-0-2" name="0-2" role="tabpanel" tabindex="0">
+                <paragraph>
+                    Oranges are orange.
+    <section ids="luminaries" names="luminaries">
+        <title>
+            Luminaries
+        <container classes="sphinx-tabs" type="tab-element">
+            <div aria-label="Tabbed content" classes="closeable" role="tablist">
+                <button aria-controls="panel-1-1-0" aria-selected="true" classes="sphinx-tabs-tab" ids="tab-1-1-0" name="1-0" role="tab" tabindex="0">
+                    Sun
+                <button aria-controls="panel-1-1-1" aria-selected="false" classes="sphinx-tabs-tab" ids="tab-1-1-1" name="1-1" role="tab" tabindex="-1">
+                    Moon
+            <div aria-labelledby="tab-1-1-0" classes="sphinx-tabs-panel" ids="panel-1-1-0" name="1-0" role="tabpanel" tabindex="0">
+                <paragraph>
+                    The sun is a star.
+            <div aria-labelledby="tab-1-1-1" classes="sphinx-tabs-panel" hidden="true" ids="panel-1-1-1" name="1-1" role="tabpanel" tabindex="0">
+                <paragraph>
+                    The moon is not a star.
+    <section ids="code-tabs" names="code\ tabs">
+        <title>
+            Code Tabs
+        <container classes="sphinx-tabs" type="tab-element">
+            <div aria-label="Tabbed content" classes="closeable" role="tablist">
+                <button aria-controls="panel-2-Qw==" aria-selected="true" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-2-Qw==" name="Qw==" role="tab" tabindex="0">
+                    C
+                <button aria-controls="panel-2-Qysr" aria-selected="false" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-2-Qysr" name="Qysr" role="tab" tabindex="-1">
+                    C++
+                <button aria-controls="panel-2-UHl0aG9u" aria-selected="false" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-2-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="-1">
+                    Python
+                <button aria-controls="panel-2-SmF2YQ==" aria-selected="false" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-2-SmF2YQ==" name="SmF2YQ==" role="tab" tabindex="-1">
+                    Java
+                <button aria-controls="panel-2-SnVsaWE=" aria-selected="false" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-2-SnVsaWE=" name="SnVsaWE=" role="tab" tabindex="-1">
+                    Julia
+                <button aria-controls="panel-2-Rm9ydHJhbg==" aria-selected="false" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-2-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tab" tabindex="-1">
+                    Fortran
+            <div aria-labelledby="tab-2-Qw==" classes="sphinx-tabs-panel code-tab group-tab" ids="panel-2-Qw==" name="Qw==" role="tabpanel" tabindex="0">
+                <literal_block force="False" highlight_args="{}" language="c" xml:space="preserve">
+                    C Main Function
+            <div aria-labelledby="tab-2-Qysr" classes="sphinx-tabs-panel code-tab group-tab" hidden="true" ids="panel-2-Qysr" name="Qysr" role="tabpanel" tabindex="0">
+                <literal_block force="False" highlight_args="{}" language="c++" xml:space="preserve">
+                    C++ Main Function
+            <div aria-labelledby="tab-2-UHl0aG9u" classes="sphinx-tabs-panel code-tab group-tab" hidden="true" ids="panel-2-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0">
+                <literal_block force="False" highlight_args="{}" language="py" xml:space="preserve">
+                    Python Main Function
+            <div aria-labelledby="tab-2-SmF2YQ==" classes="sphinx-tabs-panel code-tab group-tab" hidden="true" ids="panel-2-SmF2YQ==" name="SmF2YQ==" role="tabpanel" tabindex="0">
+                <literal_block force="False" highlight_args="{}" language="java" xml:space="preserve">
+                    Java Main Function
+            <div aria-labelledby="tab-2-SnVsaWE=" classes="sphinx-tabs-panel code-tab group-tab" hidden="true" ids="panel-2-SnVsaWE=" name="SnVsaWE=" role="tabpanel" tabindex="0">
+                <literal_block force="False" highlight_args="{}" language="julia" xml:space="preserve">
+                    Julia Main Function
+            <div aria-labelledby="tab-2-Rm9ydHJhbg==" classes="sphinx-tabs-panel code-tab group-tab" hidden="true" ids="panel-2-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tabpanel" tabindex="0">
+                <literal_block force="False" highlight_args="{}" language="fortran" xml:space="preserve">
+                    Fortran Main Function
+        <container classes="sphinx-tabs" type="tab-element">
+            <div aria-label="Tabbed content" classes="closeable" role="tablist">
+                <button aria-controls="panel-3-Qw==" aria-selected="true" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-3-Qw==" name="Qw==" role="tab" tabindex="0">
+                    C
+                <button aria-controls="panel-3-Qysr" aria-selected="false" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-3-Qysr" name="Qysr" role="tab" tabindex="-1">
+                    C++
+                <button aria-controls="panel-3-UHl0aG9u" aria-selected="false" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-3-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="-1">
+                    Python
+                <button aria-controls="panel-3-SmF2YQ==" aria-selected="false" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-3-SmF2YQ==" name="SmF2YQ==" role="tab" tabindex="-1">
+                    Java
+                <button aria-controls="panel-3-SnVsaWE=" aria-selected="false" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-3-SnVsaWE=" name="SnVsaWE=" role="tab" tabindex="-1">
+                    Julia
+                <button aria-controls="panel-3-Rm9ydHJhbg==" aria-selected="false" classes="sphinx-tabs-tab code-tab group-tab" ids="tab-3-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tab" tabindex="-1">
+                    Fortran
+            <div aria-labelledby="tab-3-Qw==" classes="sphinx-tabs-panel code-tab group-tab" ids="panel-3-Qw==" name="Qw==" role="tabpanel" tabindex="0">
+                <literal_block force="False" highlight_args="{}" language="c" xml:space="preserve">
+                    int main(const int argc, const char **argv) {
+                      return 0;
+                    }
+            <div aria-labelledby="tab-3-Qysr" classes="sphinx-tabs-panel code-tab group-tab" hidden="true" ids="panel-3-Qysr" name="Qysr" role="tabpanel" tabindex="0">
+                <literal_block force="False" highlight_args="{}" language="c++" xml:space="preserve">
+                    int main(const int argc, const char **argv) {
+                      return 0;
+                    }
+            <div aria-labelledby="tab-3-UHl0aG9u" classes="sphinx-tabs-panel code-tab group-tab" hidden="true" ids="panel-3-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0">
+                <literal_block force="False" highlight_args="{}" language="py" xml:space="preserve">
+                    def main():
+                        return
+            <div aria-labelledby="tab-3-SmF2YQ==" classes="sphinx-tabs-panel code-tab group-tab" hidden="true" ids="panel-3-SmF2YQ==" name="SmF2YQ==" role="tabpanel" tabindex="0">
+                <literal_block force="False" highlight_args="{}" language="java" xml:space="preserve">
+                    class Main {
+                        public static void main(String[] args) {
+                        }
+                    }
+            <div aria-labelledby="tab-3-SnVsaWE=" classes="sphinx-tabs-panel code-tab group-tab" hidden="true" ids="panel-3-SnVsaWE=" name="SnVsaWE=" role="tabpanel" tabindex="0">
+                <literal_block force="False" highlight_args="{}" language="julia" xml:space="preserve">
+                    function main()
+                    end
+            <div aria-labelledby="tab-3-Rm9ydHJhbg==" classes="sphinx-tabs-panel code-tab group-tab" hidden="true" ids="panel-3-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tabpanel" tabindex="0">
+                <literal_block force="False" highlight_args="{}" language="fortran" xml:space="preserve">
+                    PROGRAM main
+                    END PROGRAM main
+    <section ids="group-tabs" names="group\ tabs">
+        <title>
+            Group Tabs
+        <container classes="sphinx-tabs" type="tab-element">
+            <div aria-label="Tabbed content" classes="closeable" role="tablist">
+                <button aria-controls="panel-4-TGludXg=" aria-selected="true" classes="sphinx-tabs-tab group-tab" ids="tab-4-TGludXg=" name="TGludXg=" role="tab" tabindex="0">
+                    Linux
+                <button aria-controls="panel-4-TWFjIE9TWA==" aria-selected="false" classes="sphinx-tabs-tab group-tab" ids="tab-4-TWFjIE9TWA==" name="TWFjIE9TWA==" role="tab" tabindex="-1">
+                    Mac OSX
+                <button aria-controls="panel-4-V2luZG93cw==" aria-selected="false" classes="sphinx-tabs-tab group-tab" ids="tab-4-V2luZG93cw==" name="V2luZG93cw==" role="tab" tabindex="-1">
+                    Windows
+            <div aria-labelledby="tab-4-TGludXg=" classes="sphinx-tabs-panel group-tab" ids="panel-4-TGludXg=" name="TGludXg=" role="tabpanel" tabindex="0">
+                <paragraph>
+                    Linux Line 1
+            <div aria-labelledby="tab-4-TWFjIE9TWA==" classes="sphinx-tabs-panel group-tab" hidden="true" ids="panel-4-TWFjIE9TWA==" name="TWFjIE9TWA==" role="tabpanel" tabindex="0">
+                <paragraph>
+                    Mac OSX Line 1
+            <div aria-labelledby="tab-4-V2luZG93cw==" classes="sphinx-tabs-panel group-tab" hidden="true" ids="panel-4-V2luZG93cw==" name="V2luZG93cw==" role="tabpanel" tabindex="0">
+                <paragraph>
+                    Windows Line 1
+        <container classes="sphinx-tabs" type="tab-element">
+            <div aria-label="Tabbed content" classes="closeable" role="tablist">
+                <button aria-controls="panel-5-TGludXg=" aria-selected="true" classes="sphinx-tabs-tab group-tab" ids="tab-5-TGludXg=" name="TGludXg=" role="tab" tabindex="0">
+                    Linux
+                <button aria-controls="panel-5-TWFjIE9TWA==" aria-selected="false" classes="sphinx-tabs-tab group-tab" ids="tab-5-TWFjIE9TWA==" name="TWFjIE9TWA==" role="tab" tabindex="-1">
+                    Mac OSX
+                <button aria-controls="panel-5-V2luZG93cw==" aria-selected="false" classes="sphinx-tabs-tab group-tab" ids="tab-5-V2luZG93cw==" name="V2luZG93cw==" role="tab" tabindex="-1">
+                    Windows
+            <div aria-labelledby="tab-5-TGludXg=" classes="sphinx-tabs-panel group-tab" ids="panel-5-TGludXg=" name="TGludXg=" role="tabpanel" tabindex="0">
+                <paragraph>
+                    Linux Line 2
+            <div aria-labelledby="tab-5-TWFjIE9TWA==" classes="sphinx-tabs-panel group-tab" hidden="true" ids="panel-5-TWFjIE9TWA==" name="TWFjIE9TWA==" role="tabpanel" tabindex="0">
+                <paragraph>
+                    Mac OSX Line 2
+            <div aria-labelledby="tab-5-V2luZG93cw==" classes="sphinx-tabs-panel group-tab" hidden="true" ids="panel-5-V2luZG93cw==" name="V2luZG93cw==" role="tabpanel" tabindex="0">
+                <paragraph>
+                    Windows Line 2
diff --git a/tests/test_build/test_conditional_assets_index_.html b/tests/test_build/test_conditional_assets_index_.html
index 77da0ec..c9ba110 100644
--- a/tests/test_build/test_conditional_assets_index_.html
+++ b/tests/test_build/test_conditional_assets_index_.html
@@ -109,50 +109,26 @@
      </div>
      <div aria-labelledby="tab-2-Qw==" class="sphinx-tabs-panel code-tab group-tab" id="panel-2-Qw==" name="Qw==" role="tabpanel" tabindex="0">
       <div class="highlight-c notranslate">
-       <div class="highlight">
-        <pre><span></span><span class="n">C</span> <span class="n">Main</span> <span class="n">Function</span>
-</pre>
-       </div>
       </div>
      </div>
      <div aria-labelledby="tab-2-Qysr" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-2-Qysr" name="Qysr" role="tabpanel" tabindex="0">
       <div class="highlight-c++ notranslate">
-       <div class="highlight">
-        <pre><span></span><span class="n">C</span><span class="o">++</span> <span class="n">Main</span> <span class="n">Function</span>
-</pre>
-       </div>
       </div>
      </div>
      <div aria-labelledby="tab-2-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-2-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0">
       <div class="highlight-py notranslate">
-       <div class="highlight">
-        <pre><span></span><span class="n">Python</span> <span class="n">Main</span> <span class="n">Function</span>
-</pre>
-       </div>
       </div>
      </div>
      <div aria-labelledby="tab-2-SmF2YQ==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-2-SmF2YQ==" name="SmF2YQ==" role="tabpanel" tabindex="0">
       <div class="highlight-java notranslate">
-       <div class="highlight">
-        <pre><span></span><span class="n">Java</span> <span class="n">Main</span> <span class="n">Function</span>
-</pre>
-       </div>
       </div>
      </div>
      <div aria-labelledby="tab-2-SnVsaWE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-2-SnVsaWE=" name="SnVsaWE=" role="tabpanel" tabindex="0">
       <div class="highlight-julia notranslate">
-       <div class="highlight">
-        <pre><span></span><span class="n">Julia</span> <span class="n">Main</span> <span class="kt">Function</span>
-</pre>
-       </div>
       </div>
      </div>
      <div aria-labelledby="tab-2-Rm9ydHJhbg==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-2-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tabpanel" tabindex="0">
       <div class="highlight-fortran notranslate">
-       <div class="highlight">
-        <pre><span></span><span class="n">Fortran</span> <span class="n">Main</span> <span class="k">Function</span>
-</pre>
-       </div>
       </div>
      </div>
     </div>
@@ -179,60 +155,26 @@
      </div>
      <div aria-labelledby="tab-3-Qw==" class="sphinx-tabs-panel code-tab group-tab" id="panel-3-Qw==" name="Qw==" role="tabpanel" tabindex="0">
       <div class="highlight-c notranslate">
-       <div class="highlight">
-        <pre><span></span><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="k">const</span> <span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span> <span class="p">{</span>
-  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
-<span class="p">}</span>
-</pre>
-       </div>
       </div>
      </div>
      <div aria-labelledby="tab-3-Qysr" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-3-Qysr" name="Qysr" role="tabpanel" tabindex="0">
       <div class="highlight-c++ notranslate">
-       <div class="highlight">
-        <pre><span></span><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="k">const</span> <span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span> <span class="p">{</span>
-  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
-<span class="p">}</span>
-</pre>
-       </div>
       </div>
      </div>
      <div aria-labelledby="tab-3-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-3-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0">
       <div class="highlight-py notranslate">
-       <div class="highlight">
-        <pre><span></span><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
-    <span class="k">return</span>
-</pre>
-       </div>
       </div>
      </div>
      <div aria-labelledby="tab-3-SmF2YQ==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-3-SmF2YQ==" name="SmF2YQ==" role="tabpanel" tabindex="0">
       <div class="highlight-java notranslate">
-       <div class="highlight">
-        <pre><span></span><span class="kd">class</span> <span class="nc">Main</span> <span class="p">{</span>
-    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
-    <span class="p">}</span>
-<span class="p">}</span>
-</pre>
-       </div>
       </div>
      </div>
      <div aria-labelledby="tab-3-SnVsaWE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-3-SnVsaWE=" name="SnVsaWE=" role="tabpanel" tabindex="0">
       <div class="highlight-julia notranslate">
-       <div class="highlight">
-        <pre><span></span><span class="k">function</span> <span class="n">main</span><span class="p">()</span>
-<span class="k">end</span>
-</pre>
-       </div>
       </div>
      </div>
      <div aria-labelledby="tab-3-Rm9ydHJhbg==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-3-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tabpanel" tabindex="0">
       <div class="highlight-fortran notranslate">
-       <div class="highlight">
-        <pre><span></span><span class="k">PROGRAM </span><span class="n">main</span>
-<span class="k">END PROGRAM </span><span class="n">main</span>
-</pre>
-       </div>
       </div>
      </div>
     </div>
diff --git a/tests/test_build/test_conditional_assets_no_tabs1_.html b/tests/test_build/test_conditional_assets_no_tabs1_.html
index 77da0ec..c9ba110 100644
--- a/tests/test_build/test_conditional_assets_no_tabs1_.html
+++ b/tests/test_build/test_conditional_assets_no_tabs1_.html
@@ -109,50 +109,26 @@
      </div>
      <div aria-labelledby="tab-2-Qw==" class="sphinx-tabs-panel code-tab group-tab" id="panel-2-Qw==" name="Qw==" role="tabpanel" tabindex="0">
       <div class="highlight-c notranslate">
-       <div class="highlight">
-        <pre><span></span><span class="n">C</span> <span class="n">Main</span> <span class="n">Function</span>
-</pre>
-       </div>
       </div>
      </div>
      <div aria-labelledby="tab-2-Qysr" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-2-Qysr" name="Qysr" role="tabpanel" tabindex="0">
       <div class="highlight-c++ notranslate">
-       <div class="highlight">
-        <pre><span></span><span class="n">C</span><span class="o">++</span> <span class="n">Main</span> <span class="n">Function</span>
-</pre>
-       </div>
       </div>
      </div>
      <div aria-labelledby="tab-2-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-2-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0">
       <div class="highlight-py notranslate">
-       <div class="highlight">
-        <pre><span></span><span class="n">Python</span> <span class="n">Main</span> <span class="n">Function</span>
-</pre>
-       </div>
       </div>
      </div>
      <div aria-labelledby="tab-2-SmF2YQ==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-2-SmF2YQ==" name="SmF2YQ==" role="tabpanel" tabindex="0">
       <div class="highlight-java notranslate">
-       <div class="highlight">
-        <pre><span></span><span class="n">Java</span> <span class="n">Main</span> <span class="n">Function</span>
-</pre>
-       </div>
       </div>
      </div>
      <div aria-labelledby="tab-2-SnVsaWE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-2-SnVsaWE=" name="SnVsaWE=" role="tabpanel" tabindex="0">
       <div class="highlight-julia notranslate">
-       <div class="highlight">
-        <pre><span></span><span class="n">Julia</span> <span class="n">Main</span> <span class="kt">Function</span>
-</pre>
-       </div>
       </div>
      </div>
      <div aria-labelledby="tab-2-Rm9ydHJhbg==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-2-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tabpanel" tabindex="0">
       <div class="highlight-fortran notranslate">
-       <div class="highlight">
-        <pre><span></span><span class="n">Fortran</span> <span class="n">Main</span> <span class="k">Function</span>
-</pre>
-       </div>
       </div>
      </div>
     </div>
@@ -179,60 +155,26 @@
      </div>
      <div aria-labelledby="tab-3-Qw==" class="sphinx-tabs-panel code-tab group-tab" id="panel-3-Qw==" name="Qw==" role="tabpanel" tabindex="0">
       <div class="highlight-c notranslate">
-       <div class="highlight">
-        <pre><span></span><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="k">const</span> <span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span> <span class="p">{</span>
-  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
-<span class="p">}</span>
-</pre>
-       </div>
       </div>
      </div>
      <div aria-labelledby="tab-3-Qysr" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-3-Qysr" name="Qysr" role="tabpanel" tabindex="0">
       <div class="highlight-c++ notranslate">
-       <div class="highlight">
-        <pre><span></span><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="k">const</span> <span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span> <span class="p">{</span>
-  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
-<span class="p">}</span>
-</pre>
-       </div>
       </div>
      </div>
      <div aria-labelledby="tab-3-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-3-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0">
       <div class="highlight-py notranslate">
-       <div class="highlight">
-        <pre><span></span><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
-    <span class="k">return</span>
-</pre>
-       </div>
       </div>
      </div>
      <div aria-labelledby="tab-3-SmF2YQ==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-3-SmF2YQ==" name="SmF2YQ==" role="tabpanel" tabindex="0">
       <div class="highlight-java notranslate">
-       <div class="highlight">
-        <pre><span></span><span class="kd">class</span> <span class="nc">Main</span> <span class="p">{</span>
-    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
-    <span class="p">}</span>
-<span class="p">}</span>
-</pre>
-       </div>
       </div>
      </div>
      <div aria-labelledby="tab-3-SnVsaWE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-3-SnVsaWE=" name="SnVsaWE=" role="tabpanel" tabindex="0">
       <div class="highlight-julia notranslate">
-       <div class="highlight">
-        <pre><span></span><span class="k">function</span> <span class="n">main</span><span class="p">()</span>
-<span class="k">end</span>
-</pre>
-       </div>
       </div>
      </div>
      <div aria-labelledby="tab-3-Rm9ydHJhbg==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-3-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tabpanel" tabindex="0">
       <div class="highlight-fortran notranslate">
-       <div class="highlight">
-        <pre><span></span><span class="k">PROGRAM </span><span class="n">main</span>
-<span class="k">END PROGRAM </span><span class="n">main</span>
-</pre>
-       </div>
       </div>
      </div>
     </div>
diff --git a/tests/test_build/test_conditional_assets_no_tabs2_.html b/tests/test_build/test_conditional_assets_no_tabs2_.html
index 77da0ec..c9ba110 100644
--- a/tests/test_build/test_conditional_assets_no_tabs2_.html
+++ b/tests/test_build/test_conditional_assets_no_tabs2_.html
@@ -109,50 +109,26 @@
      </div>
      <div aria-labelledby="tab-2-Qw==" class="sphinx-tabs-panel code-tab group-tab" id="panel-2-Qw==" name="Qw==" role="tabpanel" tabindex="0">
       <div class="highlight-c notranslate">
-       <div class="highlight">
-        <pre><span></span><span class="n">C</span> <span class="n">Main</span> <span class="n">Function</span>
-</pre>
-       </div>
       </div>
      </div>
      <div aria-labelledby="tab-2-Qysr" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-2-Qysr" name="Qysr" role="tabpanel" tabindex="0">
       <div class="highlight-c++ notranslate">
-       <div class="highlight">
-        <pre><span></span><span class="n">C</span><span class="o">++</span> <span class="n">Main</span> <span class="n">Function</span>
-</pre>
-       </div>
       </div>
      </div>
      <div aria-labelledby="tab-2-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-2-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0">
       <div class="highlight-py notranslate">
-       <div class="highlight">
-        <pre><span></span><span class="n">Python</span> <span class="n">Main</span> <span class="n">Function</span>
-</pre>
-       </div>
       </div>
      </div>
      <div aria-labelledby="tab-2-SmF2YQ==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-2-SmF2YQ==" name="SmF2YQ==" role="tabpanel" tabindex="0">
       <div class="highlight-java notranslate">
-       <div class="highlight">
-        <pre><span></span><span class="n">Java</span> <span class="n">Main</span> <span class="n">Function</span>
-</pre>
-       </div>
       </div>
      </div>
      <div aria-labelledby="tab-2-SnVsaWE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-2-SnVsaWE=" name="SnVsaWE=" role="tabpanel" tabindex="0">
       <div class="highlight-julia notranslate">
-       <div class="highlight">
-        <pre><span></span><span class="n">Julia</span> <span class="n">Main</span> <span class="kt">Function</span>
-</pre>
-       </div>
       </div>
      </div>
      <div aria-labelledby="tab-2-Rm9ydHJhbg==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-2-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tabpanel" tabindex="0">
       <div class="highlight-fortran notranslate">
-       <div class="highlight">
-        <pre><span></span><span class="n">Fortran</span> <span class="n">Main</span> <span class="k">Function</span>
-</pre>
-       </div>
       </div>
      </div>
     </div>
@@ -179,60 +155,26 @@
      </div>
      <div aria-labelledby="tab-3-Qw==" class="sphinx-tabs-panel code-tab group-tab" id="panel-3-Qw==" name="Qw==" role="tabpanel" tabindex="0">
       <div class="highlight-c notranslate">
-       <div class="highlight">
-        <pre><span></span><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="k">const</span> <span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span> <span class="p">{</span>
-  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
-<span class="p">}</span>
-</pre>
-       </div>
       </div>
      </div>
      <div aria-labelledby="tab-3-Qysr" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-3-Qysr" name="Qysr" role="tabpanel" tabindex="0">
       <div class="highlight-c++ notranslate">
-       <div class="highlight">
-        <pre><span></span><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="k">const</span> <span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span> <span class="p">{</span>
-  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
-<span class="p">}</span>
-</pre>
-       </div>
       </div>
      </div>
      <div aria-labelledby="tab-3-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-3-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0">
       <div class="highlight-py notranslate">
-       <div class="highlight">
-        <pre><span></span><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
-    <span class="k">return</span>
-</pre>
-       </div>
       </div>
      </div>
      <div aria-labelledby="tab-3-SmF2YQ==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-3-SmF2YQ==" name="SmF2YQ==" role="tabpanel" tabindex="0">
       <div class="highlight-java notranslate">
-       <div class="highlight">
-        <pre><span></span><span class="kd">class</span> <span class="nc">Main</span> <span class="p">{</span>
-    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
-    <span class="p">}</span>
-<span class="p">}</span>
-</pre>
-       </div>
       </div>
      </div>
      <div aria-labelledby="tab-3-SnVsaWE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-3-SnVsaWE=" name="SnVsaWE=" role="tabpanel" tabindex="0">
       <div class="highlight-julia notranslate">
-       <div class="highlight">
-        <pre><span></span><span class="k">function</span> <span class="n">main</span><span class="p">()</span>
-<span class="k">end</span>
-</pre>
-       </div>
       </div>
      </div>
      <div aria-labelledby="tab-3-Rm9ydHJhbg==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-3-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tabpanel" tabindex="0">
       <div class="highlight-fortran notranslate">
-       <div class="highlight">
-        <pre><span></span><span class="k">PROGRAM </span><span class="n">main</span>
-<span class="k">END PROGRAM </span><span class="n">main</span>
-</pre>
-       </div>
       </div>
      </div>
     </div>
diff --git a/tests/test_build/test_custom_lexer.html b/tests/test_build/test_custom_lexer.html
index 570ebc6..954a10a 100644
--- a/tests/test_build/test_custom_lexer.html
+++ b/tests/test_build/test_custom_lexer.html
@@ -12,19 +12,10 @@
     </div>
     <div aria-labelledby="tab-0-QllP" class="sphinx-tabs-panel code-tab group-tab" id="panel-0-QllP" name="QllP" role="tabpanel" tabindex="0">
      <div class="highlight-byo notranslate">
-      <div class="highlight">
-       <pre><span></span><span class="k">Test</span>
-This is just a test.
-</pre>
-      </div>
      </div>
     </div>
     <div aria-labelledby="tab-0-QllP-1" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-0-QllP-1" name="QllP-1" role="tabpanel" tabindex="0">
      <div class="highlight-byo notranslate">
-      <div class="highlight">
-       <pre><span></span>Some other text.
-</pre>
-      </div>
      </div>
     </div>
    </div>
diff --git a/tests/test_build/test_other_with_assets.html b/tests/test_build/test_other_with_assets.html
index 660ff3a..7f5c9df 100644
--- a/tests/test_build/test_other_with_assets.html
+++ b/tests/test_build/test_other_with_assets.html
@@ -20,10 +20,6 @@
          </div>
         </td>
         <td class="code">
-         <div class="highlight">
-          <pre><span></span><span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"hello world"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
-</pre>
-         </div>
         </td>
        </tr>
       </table>
@@ -31,10 +27,6 @@
     </div>
     <div aria-labelledby="tab-0-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-0-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0">
      <div class="highlight-python notranslate">
-      <div class="highlight">
-       <pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">'hello world'</span><span class="p">)</span>
-</pre>
-      </div>
      </div>
     </div>
    </div>
diff --git a/tests/test_build/test_other_with_assets_new_style.html b/tests/test_build/test_other_with_assets_new_style.html
index d6e13a5..85b55c4 100644
--- a/tests/test_build/test_other_with_assets_new_style.html
+++ b/tests/test_build/test_other_with_assets_new_style.html
@@ -12,18 +12,10 @@
     </div>
     <div aria-labelledby="tab-0-Qysr" class="sphinx-tabs-panel code-tab group-tab" id="panel-0-Qysr" name="Qysr" role="tabpanel" tabindex="0">
      <div class="highlight-c++ notranslate">
-      <div class="highlight">
-       <pre><span></span><span class="linenos">1</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"hello world"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
-</pre>
-      </div>
      </div>
     </div>
     <div aria-labelledby="tab-0-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-0-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0">
      <div class="highlight-python notranslate">
-      <div class="highlight">
-       <pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">'hello world'</span><span class="p">)</span>
-</pre>
-      </div>
      </div>
     </div>
    </div>
